"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[502],{86699:function(Te,A,r){r.r(A),r.d(A,{default:function(){return oe}});var H=r(97857),N=r.n(H),V=r(15009),h=r.n(V),W=r(99289),b=r.n(W),w=r(5574),v=r.n(w),z=r(28248),e=r(85893),J=function(p){var a=p.title,n=p.modalVisible,T=p.hideModal,C=p.modalContent,Z=p.footer,g=p.modalWidth;return(0,e.jsx)(z.Z,{title:a,open:n,onCancel:T,footer:Z,width:g,children:C})},K=J,O=r(80854),S=r(66309),L=r(38703),Q=r(83062),Y=r(11499),X=r(74330),R=r(4393),i=r(26412),q=function(p){var a=p.record,n=(0,O.useIntl)(),T=sessionStorage.getItem("mj-image-prefix")||"",C=function(s){var m="default";return s=="NOT_START"?m="default":s=="SUBMITTED"?m="lime":s=="MODAL"?m="warning":s=="IN_PROGRESS"?m="processing":s=="FAILURE"?m="error":s=="SUCCESS"?m="success":s=="CANCEL"&&(m="magenta"),(0,e.jsx)(S.Z,{color:m,children:a.displays.status})},Z=function(s){var m=0;s&&s.indexOf("%")>0&&(m=parseInt(s.substring(0,s.indexOf("%"))));var x="normal";return a.status=="SUCCESS"?x="success":a.status=="FAILURE"&&(x="exception"),(0,e.jsx)("div",{style:{width:200},children:(0,e.jsx)(L.Z,{percent:m,status:x})})},g=function(s){return!s||s.length<30?s:(0,e.jsx)(Q.Z,{title:s,children:s.substring(0,30)+"..."})},y=function(s){return s&&(0,e.jsx)(Y.Z,{width:200,src:T+s,placeholder:(0,e.jsx)(X.Z,{tip:"Loading",size:"large"})})},k=function(s){return s=="NIJI_JOURNEY"?(0,e.jsx)(S.Z,{color:"green",children:"niji\u30FBjourney"}):s=="INSIGHT_FACE"?(0,e.jsx)(S.Z,{color:"volcano",children:"InsightFace"}):(0,e.jsx)(S.Z,{color:"blue",children:"Midjourney"})},E=function(s){if(!(s==null||!s))return(0,e.jsx)(S.Z,{color:"green",children:n.formatMessage({id:"pages.yes"})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(R.Z,{type:"inner",title:n.formatMessage({id:"pages.account.basicInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(i.Z,{column:2,children:[(0,e.jsx)(i.Z.Item,{label:"ID",children:a.id}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.type"}),children:a.displays.action}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.status"}),children:C(a.status)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.progress"}),children:Z(a.progress)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.prompt"}),children:g(a.prompt)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.promptEn"}),children:g(a.promptEn)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.description"}),children:g(a.description)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.submitTime"}),children:a.displays.submitTime}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.startTime"}),children:a.displays.startTime}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.finishTime"}),children:a.displays.finishTime}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.failReason"}),children:g(a.failReason)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.state"}),children:g(a.state)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.image"}),children:y(a.imageUrl)})]})}),(0,e.jsx)(R.Z,{type:"inner",title:n.formatMessage({id:"pages.task.extendedInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(i.Z,{column:2,children:[(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.botType"}),children:k(a.botType)}),(0,e.jsx)(i.Z.Item,{label:"Nonce",children:a.nonce}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.account.channelId"}),children:a.properties.discordInstanceId}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.instanceId"}),children:a.properties.discordInstanceId}),(0,e.jsx)(i.Z.Item,{label:"Hash",children:a.properties.messageHash}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.messageContent"}),children:g(a.properties.messageContent)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.finalPrompt"}),children:g(a.properties.finalPrompt)}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.finalPromptZh"}),children:g(a.promptCn||"-")}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.actionId"}),children:g(a.properties.custom_id||"-")}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.modalConfirm"}),children:E(a.properties.needModel)||"-"}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.imageSeed"}),children:a.seed||"-"}),(0,e.jsx)(i.Z.Item,{label:n.formatMessage({id:"pages.task.notifyHook"}),children:g(a.properties.notifyHook||"-")})]})})]})},_=q,U=r(66927),ee=r(82061),ae=r(90930),se=r(98695),te=r(53025),re=r(16568),ne=r(86738),ie=r(14726),j=r(67294),le=function(){var p=(0,j.useState)(!1),a=v()(p,2),n=a[0],T=a[1],C=(0,j.useState)({}),Z=v()(C,2),g=Z[0],y=Z[1],k=(0,j.useState)(""),E=v()(k,2),I=E[0],s=E[1],m=(0,j.useState)({}),x=v()(m,2),de=x[0],P=x[1],ue=(0,j.useState)(1e3),D=v()(ue,2),ce=D[0],ge=D[1],me=te.Z.useForm(),fe=v()(me,1),pe=fe[0],u=(0,O.useIntl)(),he=re.ZP.useNotification(),B=v()(he,2),$=B[0],ve=B[1],G=(0,j.useRef)(),Ie=function(){y({}),P({}),T(!1)},Me=function(t,l,o,d){pe.resetFields(),s(t),y(l),P(o),ge(d),T(!0)},Se=function(){var c=b()(h()().mark(function t(l){var o,d;return h()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,(0,U._5)(l);case 3:o=f.sent,o.success?($.success({message:"success",description:u.formatMessage({id:"pages.task.deleteSuccess"})}),(d=G.current)===null||d===void 0||d.reload()):$.error({message:"error",description:o.message}),f.next=10;break;case 7:f.prev=7,f.t0=f.catch(0),console.error(f.t0);case 10:return f.prev=10,f.finish(10);case 12:case"end":return f.stop()}},t,null,[[0,7,10,12]])}));return function(l){return c.apply(this,arguments)}}(),je=[{title:"ID",dataIndex:"id",width:160,align:"center",fixed:"left",render:function(t,l){return(0,e.jsx)("a",{onClick:function(){return Me(u.formatMessage({id:"pages.task.info"}),(0,e.jsx)(_,{record:l}),null,1100)},children:t})}},{title:u.formatMessage({id:"pages.task.type"}),dataIndex:"action",width:100,align:"center",request:function(){var c=b()(h()().mark(function l(){return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"Imagine",value:"IMAGINE"},{label:"Upscale",value:"UPSCALE"},{label:"Variation",value:"VARIATION"},{label:"Zoom",value:"ZOOM"},{label:"Pan",value:"PAN"},{label:"Describe",value:"DESCRIBE"},{label:"Blend",value:"BLEND"},{label:"Shorten",value:"SHORTEN"},{label:"SwapFace",value:"SWAP_FACE"}]);case 1:case"end":return d.stop()}},l)}));function t(){return c.apply(this,arguments)}return t}(),render:function(t,l){return l.displays.action}},{title:u.formatMessage({id:"pages.task.instanceId"}),dataIndex:"instanceId",width:180,align:"center",render:function(t,l){return l.properties.discordInstanceId}},{title:u.formatMessage({id:"pages.task.submitTime"}),dataIndex:"submitTime",width:160,hideInSearch:!0,align:"center",render:function(t,l){return l.displays.submitTime}},{title:u.formatMessage({id:"pages.task.status"}),dataIndex:"status",width:90,align:"center",request:function(){var c=b()(h()().mark(function l(){return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:u.formatMessage({id:"pages.task.NOT_START"}),value:"NOT_START"},{label:u.formatMessage({id:"pages.task.SUBMITTED"}),value:"SUBMITTED"},{label:u.formatMessage({id:"pages.task.MODAL"}),value:"MODAL"},{label:u.formatMessage({id:"pages.task.IN_PROGRESS"}),value:"IN_PROGRESS"},{label:u.formatMessage({id:"pages.task.FAILURE"}),value:"FAILURE"},{label:u.formatMessage({id:"pages.task.SUCCESS"}),value:"SUCCESS"},{label:u.formatMessage({id:"pages.task.CANCEL"}),value:"CANCEL"}]);case 1:case"end":return d.stop()}},l)}));function t(){return c.apply(this,arguments)}return t}(),render:function(t,l){var o="default";return t=="NOT_START"?o="default":t=="SUBMITTED"?o="lime":t=="MODAL"?o="warning":t=="IN_PROGRESS"?o="processing":t=="FAILURE"?o="error":t=="SUCCESS"?o="success":t=="CANCEL"&&(o="magenta"),(0,e.jsx)(S.Z,{color:o,children:l.displays.status})}},{title:u.formatMessage({id:"pages.task.progress"}),dataIndex:"progress",width:130,showInfo:!1,hideInSearch:!0,render:function(t,l){var o=0;t&&t.indexOf("%")>0&&(o=parseInt(t.substring(0,t.indexOf("%"))));var d="normal";return l.status=="SUCCESS"?d="success":l.status=="FAILURE"&&(d="exception"),(0,e.jsx)(L.Z,{percent:o,status:d,size:"small"})}},{title:u.formatMessage({id:"pages.task.description"}),dataIndex:"description",width:250,ellipsis:!0},{title:u.formatMessage({id:"pages.task.failReason"}),dataIndex:"failReason",width:220,ellipsis:!0},{title:u.formatMessage({id:"pages.operation"}),dataIndex:"operation",width:100,key:"operation",fixed:"right",align:"center",hideInSearch:!0,render:function(t,l){return(0,e.jsx)(ne.Z,{title:u.formatMessage({id:"pages.task.delete"}),description:u.formatMessage({id:"pages.task.deleteTitle"}),onConfirm:function(){return Se(l.id)},children:(0,e.jsx)(ie.ZP,{danger:!0,icon:(0,e.jsx)(ee.Z,{})})})}}];return(0,e.jsxs)(ae._z,{children:[ve,(0,e.jsx)(R.Z,{children:(0,e.jsx)(se.Z,{columns:je,scroll:{x:1e3},search:{defaultCollapsed:!0},pagination:{pageSize:10,showQuickJumper:!1,showSizeChanger:!1},rowKey:"id",actionRef:G,request:function(){var c=b()(h()().mark(function t(l){var o;return h()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,(0,U.Pn)(N()(N()({},l),{},{pageNumber:l.current-1}));case 2:return o=M.sent,M.abrupt("return",{data:o.list,total:o.pagination.total,success:!0});case 4:case"end":return M.stop()}},t)}));return function(t){return c.apply(this,arguments)}}()})}),(0,e.jsx)(K,{title:I,modalVisible:n,hideModal:Ie,modalContent:g,footer:de,modalWidth:ce})]})},oe=le}}]);
